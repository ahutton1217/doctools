<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">// jscs:disable
<span id='EjsRendererEngine'>/**
</span> * @class EjsRendererEngine
 * Renderer engine for EJS templates.
 * @extends ArrowRendererEngine
 * @pseudo
 */

<span id='EjsRendererEngine-property-skipread'>/**
</span> * @property skipread
 * @hide
 */

// jscs:enable
var ejs = require(&#39;ejs&#39;),
	fs = require(&#39;fs&#39;),
	util = require(&#39;./util&#39;);

// jscs:disable jsDoc

exports.extension = &#39;ejs&#39;;

function render(app, filename, opts) {
	filename = util.resolveLayoutFilename(app, filename);
	var tpl = ejs.compile(fs.readFileSync(filename).toString(), {filename: filename});
	return tpl(opts);
}

exports.createRenderer = function (content, filename, app) {
	var tpl;
	return function (filePath, opts, callback) {
		if (!tpl) {
			try {
				tpl = ejs.compile(content, {
					filename: filename
				});
			}
			catch (err) {
				return callback(err);
			}
		}
		var result;
		try {
			result = tpl(opts || {});
		}
		catch (err) {
			return callback(err);
		}
		util.render(app, result, opts, exports.extension, render, callback);
	};
};

<span id='EjsRendererEngine-property-ejs'>/**
</span> * @property {Object} ejs
 * ejs module instance to access its APIs.
 */
exports.ejs = ejs;
</pre>
</body>
</html>
